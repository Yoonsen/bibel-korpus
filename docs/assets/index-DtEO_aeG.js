(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();const g=[{urn:"URN:NBN:no-nb_digibok_2009021704085",title:"NTR - Det nye testamente revidert . [ 1 ] : Lukasevangeliet , Første tessalonikerbrev , Andre tessalonikerbrev , Galaterbrevet , Filipperbrevet",year:2003,publisher:"Det norske bibelselskap",langs:"nob",dhlabid:"100010961.0"},{urn:"URN:NBN:no-nb_digibok_2008052304066",title:"Det Nye testamente : oversatt for ungdom",year:1959,authors:"Osnes , Torbjørn",publisher:"Det Norske bibelselskaps forl.",langs:"nob",dhlabid:"100040613.0"},{urn:"URN:NBN:no-nb_digibok_2011060308011",title:"Det nye testamentet",year:2005,publisher:"Det norske bibelselskap",langs:"nob",dhlabid:"100048618.0"},{urn:"URN:NBN:no-nb_digibok_2012033008102",title:"Evangeliet etter Lukas",year:1973,publisher:"Det norske bibelselskap",langs:"nob",dhlabid:"100084964.0"},{urn:"URN:NBN:no-nb_digibok_2012081508153",title:"Vær ikke redde : evangeliet etter Markus",year:1951,authors:"Skard , Vemund / Osnes , Torbjørn",publisher:"Det norske bibelselskaps forlag",langs:"nob / grc",dhlabid:"100100888.0"},{urn:"URN:NBN:no-nb_digibok_2013030506026",title:"Bibelen : det Gamle og det Nye testamente : [ bokmål ]",year:1978,publisher:"Det Norske bibelselskaps forlag",langs:"nob",dhlabid:"100138726.0"},{urn:"URN:NBN:no-nb_digibok_2013020808015",title:"NTR - Det nye testamente revidert . [ 2 ] : Markusevangeliet , Romerbrevet , Første korinterbrev , Andre korinterbrev",year:2003,publisher:"Det norske bibelselskap",langs:"mul / nob / nno",dhlabid:"100139398.0"},{urn:"URN:NBN:no-nb_digibok_2013061206082",title:"NTR - Det nye testamente revidert . [ 3 ] : Matteusevangeliet , Efeserbrevet , Kolosserbrevet",year:2004,publisher:"Det norske bibelselskap",langs:"nob",dhlabid:"100152845.0"},{urn:"URN:NBN:no-nb_digibok_2015110407068",title:"Godt nytt : Det nye testamentet for menneske i dag ; illustrert av Annie Vallotton",year:1976,authors:"Vallotton , Annie",publisher:"Bibelselskapet",langs:"nno",dhlabid:"100274283.0"},{urn:"URN:NBN:no-nb_digibok_2016061748023",title:"Godt nytt : Det nye testamente for mennesker i dag : ny oversettelse av 1975",year:1975,authors:"Vallotton , Annie",publisher:"Det norske bibelselskaps forl.",langs:"nob / gre",dhlabid:"100297911.0"},{urn:"URN:NBN:no-nb_digibok_2018020748002",title:"Når Ordet blir norsk : norske bibeloversettelser 1945-2011",year:2011,authors:"Bøe , Sverre / Holmås , Geir Otto",publisher:"Tapir akademisk forl.",langs:"nob",dhlabid:"100364017.0"},{urn:"URN:NBN:no-nb_digibok_2018030805008",title:"Utvalg av det Gamle testamente : oversettelse av 1966",year:1966,publisher:"Det Norske bibelselskaps forl.",langs:"nob / heb",dhlabid:"100365478.0"},{urn:"URN:NBN:no-nb_digibok_2017091807031",title:"Bibelen , eller Den Hellige skrift : det gamle og det Nye testamentes kanoniske bøker",year:1930,publisher:"Det Norske bibelselskap",langs:"nob",dhlabid:"100482251.0"},{urn:"URN:NBN:no-nb_digibok_2019061928001",title:"Biblia : Det er den gantske Hellige Scrifft , vdsæt paa Danske",year:1550,publisher:"aff Ludowich Dietz",langs:"dan",dhlabid:"100484406.0"},{urn:"URN:NBN:no-nb_digibok_2021012648506",title:"Bibelen , eller Den hellige Skrift indeholdende det Gamle og Nye Testamentes kanoniske Bøger",year:1905,publisher:"Det norske Bibelselskabs Forl.",langs:"nob",dhlabid:"100485380.0"},{urn:"URN:NBN:no-nb_digibok_2016031029001",title:"Biblia , Paa Danske : Det er , Den gandske hellige Skriftis Bøgger , Paa ny igiennemseete , med flid , efter den Ebræiske oc Grækiske Text , det næste mueligt var , Oc forbedrede med ny Summarier , fuldkommeligere Concordantzer , oc korte antegnelser udi Bredden , anlangendis de mørcke Ord oc maader ad tale med. 3 : Den Tredie Part Af det Gamle Testamentis Bøgger",year:1647,publisher:"[ved Melchior Martzan oc Melchior Winckler]",langs:"dan",dhlabid:"100492545.0"},{urn:"URN:NBN:no-nb_digibok_2016040729001",title:"Biblia , Paa Danske : Det er , Den gandske hellige Skriftis Bøgger , Paa ny igiennemseete , med flid , efter den Ebræiske oc Grækiske Text , det næste mueligt var , Oc forbedrede med ny Summarier , fuldkommeligere Concordantzer , oc korte antegnelser udi Bredden , anlangendis de mørcke Ord oc maader ad tale med. 1 : Den første Part Af det Gamle Testamentis Bøgger",year:1647,publisher:"[ved Melchior Martzan oc Melchior Winckler]",langs:"dan",dhlabid:"100492584.0"},{urn:"URN:NBN:no-nb_digibok_2016040729002",title:"Biblia , Paa Danske : Det er , Den gandske hellige Skriftis Bøgger , Paa ny igiennemseete , med flid , efter den Ebræiske oc Grækiske Text , det næste mueligt var , Oc forbedrede med ny Summarier , fuldkommeligere Concordantzer , oc korte antegnelser udi Bredden , anlangendis de mørcke Ord oc maader ad tale med. 2 : Den Anden Part Af det gamle Testamentis Bøgger",year:1647,publisher:"[ved Melchior Martzan oc Melchior Winckler]",langs:"dan",dhlabid:"100492585.0"},{urn:"URN:NBN:no-nb_digibok_2010110206027",title:"Evangilja : eller Fagnad-bodi etter Mattæus",year:1915,authors:"Seippel , Alexander",publisher:"Det norske bibel-sellskape",langs:"nno / grc",dhlabid:"100520866.0"},{urn:"URN:NBN:no-nb_digibok_2011052608017",title:"Det nye testamentet",year:2005,publisher:"Det norske bibelselskap",langs:"nno",dhlabid:"100540180.0"},{urn:"URN:NBN:no-nb_digibok_2011053008068",title:"NTR - Det nye testamente revidert . [ 5 ] : Apostlenes gjerninger , Første timoteusbrev , Andre timoteusbrev , Brevet til Titus , Brevet til Filemon , Hebreerbrevet , Jakobs brev , Første petersbrev , Andre petersbrev , Judas ' brev",year:2005,publisher:"Det norske bibelselskap",langs:"nob",dhlabid:"100552275.0"},{urn:"URN:NBN:no-nb_digibok_2022030107531",title:"Bibelen : Den hellige skrift : Det gamle og Det nye testamente",year:1985,publisher:"Det norske bibelselskap",langs:"nob",dhlabid:"100582412.0"},{urn:"URN:NBN:no-nb_digibok_2021041548624",title:"Bibelen , eller den Hellige Skrift : indeholdende Det gamle og nye Testaments kanoniske Bøger , tilligemed Det gamle Testamentes apokryfiske Bøger",year:1908,langs:"nob",dhlabid:"100588397.0"},{urn:"URN:NBN:no-nb_digibok_2022011028001",title:"Biblia : Det er , Den gantske Hellige Scrifft , paa Danske",year:1589,authors:"Dietrich , Veit / Luther , Martin",publisher:"Aff Matz Vingaardt",langs:"dan",dhlabid:"100596484.0"},{urn:"URN:NBN:no-nb_digibok_2022011928001",title:"Biblia : Det er Den gantske Hellige Scrifft paa Danske",year:1633,authors:"Luther , Martin / Dietrich , Veit / Martzan , Melchior / Sartor , Salomon",publisher:"Prentet ved Melchior Martzan",langs:"dan",dhlabid:"100606092.0"},{urn:"URN:NBN:no-nb_digibok_2022030107535",title:"Bibelen : det Gamle og det Nye testamentet : [ nynorsk ]",year:1978,publisher:"Det Norske bibelselskap",langs:"nno",dhlabid:"100609051.0"},{urn:"URN:NBN:no-nb_digibok_2022012528002",title:"Biblia , Paa Danske : Det er Den gantske hellige scriftis Bøgger igen [ n ] em seete med flijd effter den Ebræiske oc Grækeske Text etc. det negste mueligt vaar Oc effter som de paa andre atskillige Tungemaal vaare best vdsatte",year:1607,authors:"Resen , Hans Poulsen",publisher:"[utgiver ikke identifisert]",langs:"dan",dhlabid:"100612630.0"},{urn:"URN:NBN:no-nb_digibok_2008040104074",title:"Det Nye Testamente",year:1904,publisher:"Det Norske Bibelselskabs Forl.",langs:"nob / grc",dhlabid:"100615340.0"},{urn:"URN:NBN:no-nb_digibok_2017051148061",title:"Bibelens eller Den hellige Skrifts kanoniske Bøger",year:1891,publisher:"Bibelselskabet",langs:"nob",dhlabid:"100634178.0"}];g.map(e=>e.urn);const he="https://api.nb.no/dhlab",L=he;async function ke(e,t){const a={urns:t.urns.length?t.urns:null,query:t.query,window:j(t.window,1,25),limit:j(t.limit,1,1e3)},n=await I(e,"/conc",a);return Ne(n)}async function ye(e,t){const a={urn:t.urns.length?t.urns:null,word:t.word,before:Math.max(0,t.before),after:Math.max(0,t.after),samplesize:Math.max(1,t.samplesize)},n=await I(e,"/urncolldist_urn",a);return Be(n).sort((o,l)=>{const s=o.avgDistance??Number.POSITIVE_INFINITY,c=l.avgDistance??Number.POSITIVE_INFINITY;return s-c||l.count-o.count})}async function ve(e,t){const a={urns:t.urns.length?t.urns:null,cutoff:Math.max(0,t.cutoff),words:t.words},n=await I(e,"/frequencies",a);return Array.isArray(n)?n.map(([r,o,l,s])=>({urn:r,word:o,freq:l,urncount:s,relfreq:s?l/s:0})):[]}async function I(e,t,a){const n=`${e.replace(/\/$/,"")}${t}`,r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok){const l=await r.text();throw new Error(`API-kall feilet (${r.status} ${r.statusText}): ${l}`)}const o=await r.json();return typeof o=="string"?JSON.parse(o):o}function Ne(e){return Array.isArray(e)?e:we(e)?De(e):[]}function Be(e){if(!_e(e))return[];const t=new Set;return[e.counts,e.dist,e.bdist].filter(Boolean).forEach(a=>{Object.keys(a).forEach(n=>t.add(n))}),Array.from(t).map(a=>({word:a,count:Number(e.counts?.[a]??0),distance:P(e.dist?.[a]),avgDistance:Se(P(e.dist?.[a]),Number(e.counts?.[a]??0))}))}function Se(e,t){return e==null||!Number.isFinite(e)||!t?null:e/t}function De(e){const t=new Set;return Object.values(e).forEach(n=>{Array.isArray(n)?n.forEach((r,o)=>t.add(String(o))):n&&typeof n=="object"&&Object.keys(n).forEach(r=>t.add(r))}),Array.from(t).sort((n,r)=>Number(n)-Number(r)).map(n=>{const r={};for(const[o,l]of Object.entries(e))r[o]=qe(l,n);return r})}function qe(e,t){if(Array.isArray(e)){const a=Number(t);return Number.isNaN(a)?null:e[a]}return e&&typeof e=="object"?e[t]:e}function we(e){return!!e&&typeof e=="object"}function _e(e){if(!e||typeof e!="object")return!1;const t=e,a=t.counts!==void 0&&t.counts!==null&&typeof t.counts=="object",n=t.dist!==void 0&&t.dist!==null&&typeof t.dist=="object",r=t.bdist!==void 0&&t.bdist!==null&&typeof t.bdist=="object";return a||n||r}function j(e,t,a){return Math.min(Math.max(e,t),a)}function P(e){const t=Number(e);return Number.isFinite(t)?t:null}const i=document.querySelector("#app");if(!i)throw new Error("Fant ikke rot-elementet med id #app");i.innerHTML=`
  <header class="hero">
    <div class="hero-copy">
      <p class="eyebrow">Bibel-korpus</p>
      <h1>Konkordanser & kollokasjoner</h1>
      <p>
        Velg hvilke utgaver som skal inngå i subkorpuset, og hent konkordanser
        eller kollokasjoner direkte fra NB sitt DH-lab API.
      </p>
    </div>
  </header>

  <main class="workspace">
    <div class="tabs" role="tablist">
      <button class="tab-button" type="button" data-tab-target="corpus">Korpus</button>
      <button class="tab-button" type="button" data-tab-target="concordance">Konkordanser</button>
      <button class="tab-button" type="button" data-tab-target="collocations">Kollokasjoner</button>
      <button class="tab-button" type="button" data-tab-target="frequencies">Opptelling</button>
    </div>

    <section class="panel tab-panel" data-tab="corpus" role="tabpanel">
      <header>
        <div>
          <p class="eyebrow">Subkorpus</p>
          <h2>Velg bibelutgaver</h2>
        </div>
        <output id="urn-count">0 valgt</output>
      </header>
      <div class="subkorpus-controls">
        <div class="actions">
          <button type="button" data-action="select-all">Velg alle</button>
          <button type="button" data-action="clear-all">Fjern alle</button>
        </div>
        <label class="search-label" for="urn-search">
          <span>Søk etter metadata</span>
          <input id="urn-search" type="search" placeholder="Filtrer på tittel/forfatter/år/målform" />
        </label>
      </div>
      <div id="urn-list" class="urn-list" role="list"></div>
    </section>

    <section class="panel tab-panel" data-tab="concordance" role="tabpanel">
      <header>
        <div>
          <p class="eyebrow">Konkordanser</p>
          <h2>Søk etter uttrykk</h2>
        </div>
      </header>
      <form id="conc-form" class="stack" autocomplete="off">
        <label>
          <span>Søkestreng (SQLite FTS5)</span>
          <input name="query" type="text" placeholder="" required />
        </label>
        <div class="form-grid">
          <label>
            <span>Vindusstørrelse</span>
            <input name="window" type="number" min="1" max="25" value="25" />
          </label>
          <label>
            <span>Maks linjer per dokument</span>
            <input name="limit" type="number" min="1" max="1000" value="100" />
          </label>
        </div>
        <button type="submit">Hent konkordanser</button>
      </form>
      <div class="result-actions">
        <button type="button" id="download-conc" disabled>Last ned CSV</button>
      </div>
      <div id="conc-results" class="results tall"></div>
    </section>

    <section class="panel tab-panel" data-tab="collocations" role="tabpanel">
      <header>
        <div>
          <p class="eyebrow">Kollokasjoner</p>
          <h2>Finn medkontekst</h2>
        </div>
      </header>
      <form id="coll-form" class="stack" autocomplete="off">
        <label>
          <span>Basiskord</span>
          <input name="word" type="text" value="arbeid" required />
        </label>
        <div class="form-grid">
          <label>
            <span>Ord før</span>
            <input name="before" type="number" min="0" max="25" value="5" />
          </label>
          <label>
            <span>Ord etter</span>
            <input name="after" type="number" min="0" max="25" value="5" />
          </label>
          <label>
            <span>Utvalg (samplesize)</span>
            <input name="samplesize" type="number" min="1" value="200000" />
          </label>
        </div>
        <button type="submit">Hent kollokasjoner</button>
      </form>
      <div class="result-actions">
        <button type="button" id="download-coll" disabled>Last ned CSV</button>
      </div>
      <div id="coll-results" class="results"></div>
    </section>
    <section class="panel tab-panel" data-tab="frequencies" role="tabpanel">
      <header>
        <div>
          <p class="eyebrow">Opptelling</p>
          <h2>Tell ord i utvalgte bibler</h2>
        </div>
      </header>
      <form id="freq-form" class="stack" autocomplete="off">
        <label>
          <span>Ord/uttrykk (kommaseparert)</span>
          <textarea name="words" rows="3" placeholder="helvete, evighet, etterliv" required></textarea>
        </label>
        <div class="form-grid">
          <label>
            <span>Cutoff (minimum antall)</span>
            <input name="cutoff" type="number" min="0" value="0" />
          </label>
        </div>
        <div class="mode-switch">
          <label>
            <input type="radio" name="freq-mode" value="freq" checked />
            Absolutt
          </label>
          <label>
            <input type="radio" name="freq-mode" value="relfreq" />
            Relativ
          </label>
        </div>
        <button type="submit">Tell ord</button>
      </form>
      <div class="result-actions">
        <button type="button" id="download-freq" disabled>Last ned CSV</button>
      </div>
      <div id="freq-results" class="results tall"></div>
    </section>

  </main>
`;const V=i.querySelector("#urn-list"),H=i.querySelector("#urn-count"),$=i.querySelector("#urn-search"),G=i.querySelector("#conc-results"),K=i.querySelector("#coll-results"),J=i.querySelector("#freq-results"),W=i.querySelector("#conc-form"),Q=i.querySelector("#coll-form"),Y=i.querySelector("#freq-form"),X=i.querySelector("#download-conc"),Z=i.querySelector("#download-coll"),ee=i.querySelector("#download-freq"),te=Array.from(i.querySelectorAll("[data-tab-target]")),ne=Array.from(i.querySelectorAll("[data-tab]"));if(!V||!H||!G||!K||!J||!W||!Q||!Y||!$||!X||!Z||!ee||te.length===0||ne.length===0)throw new Error("UI-elementer mangler i DOM-en");const Ee=H,k=G,y=K,p=J,B=W,v=Q,q=Y,_=$,re=X,oe=Z,ae=ee,C=V,f=new Set(g.map(e=>e.urn)),le=te,Re=ne,se=new Map;function ie(e){return e==null?"":String(e).trim().replace(/\.0+$/,"")}function z(e,t=!0,a){if(e==null)return;const n=t?ie(e):String(e);n&&se.set(n,a)}g.forEach(e=>{z(e.urn,!1,e),z(e.dhlabid,!0,e)});E();R();ge("concordance");let ce=[],de=[],ue=[],be=[],fe=[],me=[],T=[],U=[],w="freq";const A=Array.from(q.querySelectorAll('input[name="freq-mode"]'));A.length&&(w=A.find(e=>e.checked)?.value==="relfreq"?"relfreq":"freq",A.forEach(e=>{e.addEventListener("change",()=>{const t=e.value==="relfreq"?"relfreq":"freq";t!==w&&(w=t,pe())})}));i.querySelector('[data-action="select-all"]')?.addEventListener("click",()=>{Ce()});i.querySelector('[data-action="clear-all"]')?.addEventListener("click",()=>{Ae()});_.addEventListener("input",()=>{E(_.value)});le.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.tabTarget;t&&ge(t)})});B.addEventListener("submit",async e=>{e.preventDefault();const t=B.querySelector('input[name="query"]'),a=B.querySelector('input[name="window"]'),n=B.querySelector('input[name="limit"]');if(!t||!a||!n)return;const r=t.value.trim();if(!r){d(k,"Du må skrive inn en søkestreng.","error");return}d(k,"Henter konkordanser …","info"),S([],[]);try{const o=await ke(L,{urns:M(),query:r,window:parseInt(a.value,10)||25,limit:parseInt(n.value,10)||100});if(!o.length){d(k,"Ingen treff for søket.","info"),S([],[]);return}const l=o.map(c=>({...c,kilde:c.urn?`<a href="https://www.nb.no/items/${encodeURIComponent(String(c.urn))}" target="_blank" rel="noopener noreferrer">Til NB</a>`:""})),s=x(k,l,["docid","kilde","conc"],new Set(["kilde","conc"]));S(l,s)}catch(o){d(k,o.message,"error"),S([],[])}});v.addEventListener("submit",async e=>{e.preventDefault();const t=v.querySelector('input[name="word"]'),a=v.querySelector('input[name="before"]'),n=v.querySelector('input[name="after"]'),r=v.querySelector('input[name="samplesize"]');if(!t||!a||!n||!r)return;const o=t.value.trim();if(!o){d(y,"Skriv inn et basiskord.","error");return}d(y,"Henter kollokasjoner …","info"),D([],[]);try{const l=await ye(L,{urns:M(),word:o,before:parseInt(a.value,10)||5,after:parseInt(n.value,10)||5,samplesize:parseInt(r.value,10)||2e5});if(!l.length){d(y,"Ingen kollokasjoner returnert.","info"),D([],[]);return}const s=x(y,l,["word","count","avgDistance"]);D(l,s)}catch(l){d(y,l.message,"error"),D([],[])}});re.addEventListener("click",()=>{O(de,ce,"konkordanser.csv")});oe.addEventListener("click",()=>{O(be,ue,"kollokasjoner.csv")});q.addEventListener("submit",async e=>{e.preventDefault();const t=q.querySelector('textarea[name="words"]'),a=q.querySelector('input[name="cutoff"]');if(!t||!a)return;const n=t.value.split(/[,\n]/).map(o=>o.trim()).filter(Boolean);if(!n.length){d(p,"Skriv inn minst ett ord eller uttrykk.","error");return}const r=M();if(!r.length){d(p,"Velg minst én bibel i korpus-fanen.","error");return}d(p,"Henter opptelling …","info"),N([],[]);try{const o=await ve(L,{urns:r,words:n,cutoff:parseInt(a.value,10)||0});if(!o.length){d(p,"Ingen treff for disse ordene.","info"),N([],[]);return}Te(o),pe()}catch(o){d(p,o.message,"error"),N([],[])}});ae.addEventListener("click",()=>{O(me,fe,"opptelling.csv")});function E(e=""){if(!C)return;const t=e.toLowerCase().trim(),a=document.createDocumentFragment();if(g.forEach(n=>{const r=[n.title,n.authors,n.publisher,n.langs,n.year?String(n.year):""].filter(Boolean).join(" ").toLowerCase();if(t&&!r.includes(t))return;const o=document.createElement("label");o.className="urn-card",o.setAttribute("role","listitem");const l=document.createElement("input");l.type="checkbox",l.value=n.urn,l.checked=f.has(n.urn),l.addEventListener("change",()=>{l.checked?f.add(n.urn):f.delete(n.urn),R()});const s=document.createElement("div");s.className="urn-info";const c=document.createElement("p");c.className="urn-title",c.textContent=n.year?`${n.title} (${n.year})`:n.title;const b=[n.authors,n.publisher,n.langs?`Målform: ${n.langs}`:void 0].filter(Boolean),u=document.createElement("p");u.className="urn-meta",u.textContent=b.join(" • "),s.append(c),b.length&&s.append(u),o.append(l,s),a.append(o)}),a.hasChildNodes())C.replaceChildren(a);else{const n=document.createElement("p");n.className="message info",n.textContent=t?`Ingen treff for «${e.trim()}».`:"Ingen elementer i korpuset.",C.replaceChildren(n)}}function Ce(){f.clear(),g.forEach(e=>f.add(e.urn)),E(_.value),R()}function Ae(){f.clear(),E(_.value),R()}function R(){const e=f.size,t=g.length;Ee.value=e===0?"0 valgt":e===t?`Alle (${t})`:`${e} valgt`}function M(){return Array.from(f)}function d(e,t,a){e.innerHTML=`<p class="message ${a}">${t}</p>`}function x(e,t,a,n=new Set){const r=a?.length&&a?.some(b=>b in t[0])?a:Object.keys(t[0]),o=document.createElement("table"),l=document.createElement("thead"),s=document.createElement("tr");r.forEach(b=>{const u=document.createElement("th");u.textContent=b,s.appendChild(u)}),l.appendChild(s),o.appendChild(l);const c=document.createElement("tbody");return t.forEach(b=>{const u=document.createElement("tr");r.forEach(F=>{const h=document.createElement("td"),m=b[F];m==null?h.textContent="":n.has(F)&&typeof m=="string"?h.innerHTML=m:typeof m=="number"?h.textContent=Number.isFinite(m)?m.toLocaleString("nb-NO",{maximumFractionDigits:3}):"":h.textContent=String(m),u.appendChild(h)}),c.appendChild(u)}),o.appendChild(c),e.innerHTML="",e.appendChild(o),r}function S(e,t){de=e,ce=t,re.disabled=e.length===0}function D(e,t){be=e,ue=t,oe.disabled=e.length===0}function N(e,t){me=e,fe=t,ae.disabled=e.length===0}function Te(e){const t=new Set,a=new Map;e.forEach(n=>{t.add(n.word);const r=ie(n.urn),o=se.get(r),l=o?.urn??r;let s=a.get(l);s||(s={tittel:o?.title??r,år:o?.year??"",målform:o?.langs??"",values:{}},a.set(l,s)),s.values[n.word]={freq:n.freq,relfreq:n.relfreq}}),U=Array.from(t).sort((n,r)=>n.localeCompare(r,"nb")),T=Array.from(a.values()).sort((n,r)=>String(n.tittel).localeCompare(String(r.tittel),"nb"))}function pe(){if(!T.length){d(p,"Ingen data å vise.","info"),N([],[]);return}const e=["år","målform","tittel"],t=U.concat(e),a=T.map(r=>{const o={};return U.forEach(l=>{const s=r.values[l];o[l]=s?w==="relfreq"?s.relfreq:s.freq:0}),o.år=r.år??"",o.målform=r.målform??"",o.tittel=r.tittel??"",o}),n=x(p,a,t);N(a,n)}function O(e,t,a){if(!e.length)return;const n=t.length?t:Object.keys(e[0]),r=[n.join(",")];e.forEach(c=>{const b=n.map(u=>Ue(c[u])).join(",");r.push(b)});const o=new Blob([r.join(`
`)],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(o),s=document.createElement("a");s.href=l,s.download=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)}function Ue(e){const t=typeof e=="string"?e.replace(/<[^>]*>/g,""):e==null?"":String(e),a=/[",\n]/.test(t),n=t.replace(/"/g,'""');return a?`"${n}"`:n}function ge(e){le.forEach(t=>{t.classList.toggle("is-active",t.dataset.tabTarget===e)}),Re.forEach(t=>{t.classList.toggle("is-active",t.dataset.tab===e)})}
